import{j as e,B as s,F as t,a,A as l,m as i,b as r,ae as n,z as c,af as o,ag as d,U as m,K as x,p as h,ah as u}from"./ui-vendor-DKO4OaAp.js";import{r as p}from"./react-vendor-1Jw84dll.js";import{u as g,z as b}from"./index-DFbYFGYF.js";import{m as f}from"./gemini-cN2Ia3Dc.js";import{M as j,r as w}from"./markdown-vendor-DhMYsP4u.js";import"./state-Cv3e63x1.js";const v=()=>{const{user:v,currentBook:y}=g(),[N,k]=p.useState([]),[C,T]=p.useState(""),[z,A]=p.useState(!1),P=p.useRef(null),S=p.useRef(null);p.useEffect(()=>{0===N.length&&k([{id:"welcome",role:"assistant",content:`Hello ${null==v?void 0:v.name}! I'm your AI medical education assistant. I can help you:\n\n• Explain complex medical concepts\n• Answer questions about any medical topic\n• Generate practice questions and quizzes\n• Summarize chapters from your books\n• Provide clinical correlations and mnemonics\n• Help with differential diagnoses\n\nWhat would you like to learn about today?`,timestamp:new Date}])},[null==v?void 0:v.name]),p.useEffect(()=>{I()},[N]);const I=()=>{var e;null==(e=P.current)||e.scrollIntoView({behavior:"smooth"})},q=[{icon:a,text:"Explain the cardiac cycle in detail",category:"physiology"},{icon:x,text:"What are the key differences between Type 1 and Type 2 diabetes?",category:"pathology"},{icon:h,text:"Generate 5 practice questions about antibiotics",category:"pharmacology"},{icon:s,text:"Create a mnemonic for cranial nerves",category:"anatomy"}],D=()=>{return e=void 0,s=null,t=function*(){if(!C.trim()||z)return;const e={id:`msg-${Date.now()}`,role:"user",content:C.trim(),timestamp:new Date};k(s=>[...s,e]),T(""),A(!0);const s={id:`loading-${Date.now()}`,role:"assistant",content:"",timestamp:new Date,isLoading:!0};k(e=>[...e,s]);try{const s=yield f.generateResponse(e.content,{bookId:(null==y?void 0:y.id)||"general",recentTopics:N.slice(-5).map(e=>e.content.substring(0,50)),userLevel:(null==v?void 0:v.level)||"student"});k(e=>[...e.filter(e=>!e.isLoading),{id:s.id,role:"assistant",content:s.response,timestamp:s.timestamp,relatedConcepts:s.relatedConcepts,references:s.references}]),g.getState().addAIResponse(s)}catch(t){k(e=>e.filter(e=>!e.isLoading)),b.error("Failed to get AI response. Please try again.")}finally{A(!1)}},new Promise((a,l)=>{var i=e=>{try{n(t.next(e))}catch(s){l(s)}},r=e=>{try{n(t.throw(e))}catch(s){l(s)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,r);n((t=t.apply(e,s)).next())});var e,s,t},G=(e,s)=>{b.success(`Thank you for your ${s} feedback!`)};return e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"glass border-b border-white/10 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-medical-purple to-medical-pink p-0.5",children:e.jsx("div",{className:"w-full h-full rounded-full bg-medical-darker flex items-center justify-center",children:e.jsx(s,{className:"w-5 h-5 text-white"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Medical AI Assistant"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Powered by Gemini 2.5 Flash-Lite"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(N.slice(0,1)),className:"p-2 rounded-lg hover:bg-white/10 transition-colors",title:"Clear chat",children:e.jsx(t,{className:"w-5 h-5 text-gray-400"})}),y&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-medical-blue/10 border border-medical-blue/20",children:[e.jsx(a,{className:"w-4 h-4 text-medical-blue"}),e.jsx("span",{className:"text-sm text-medical-blue",children:y.title})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(l,{children:N.map(s=>e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex gap-4 "+("user"===s.role?"justify-end":"justify-start"),children:["assistant"===s.role&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-medical-purple to-medical-pink p-0.5",children:e.jsx("div",{className:"w-full h-full rounded-full bg-medical-darker flex items-center justify-center",children:e.jsx(r,{className:"w-5 h-5 text-white"})})})}),e.jsxs("div",{className:"flex-1 max-w-2xl "+("user"===s.role?"order-1":"order-2"),children:[e.jsx("div",{className:"rounded-2xl px-5 py-4 "+("user"===s.role?"bg-medical-blue/20 border border-medical-blue/30":"glass border border-white/10"),children:s.isLoading?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-4 h-4 animate-spin text-medical-purple"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Thinking..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx(j,{remarkPlugins:[w],children:s.content})}),s.relatedConcepts&&s.relatedConcepts.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Related concepts:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.relatedConcepts.map((s,t)=>e.jsx("span",{className:"px-2 py-1 rounded-full bg-white/5 text-xs text-gray-300",children:s},t))})]}),"assistant"===s.role&&e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{return e=s.content,navigator.clipboard.writeText(e),void b.success("Copied to clipboard");var e},className:"p-1.5 rounded hover:bg-white/10 transition-colors",title:"Copy",children:e.jsx(c,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>G(s.id,"positive"),className:"p-1.5 rounded hover:bg-white/10 transition-colors",title:"Good response",children:e.jsx(o,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>G(s.id,"negative"),className:"p-1.5 rounded hover:bg-white/10 transition-colors",title:"Poor response",children:e.jsx(d,{className:"w-4 h-4 text-gray-400"})})]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 px-2",children:s.timestamp.toLocaleTimeString()})]}),"user"===s.role&&e.jsx("div",{className:"flex-shrink-0 order-2",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-medical-cyan to-medical-blue flex items-center justify-center",children:e.jsx(m,{className:"w-5 h-5 text-white"})})})]},s.id))}),e.jsx("div",{ref:P})]})}),1===N.length&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Try asking:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:q.map((s,t)=>{const a=s.icon;return e.jsxs(i.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>T(s.text),className:"flex items-start gap-3 p-4 rounded-xl glass border border-white/10 hover:border-medical-blue/50 transition-all text-left",children:[e.jsx(a,{className:"w-5 h-5 text-medical-blue mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-white",children:s.text}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 capitalize",children:s.category})]})]},t)})})]})}),e.jsx("div",{className:"glass border-t border-white/10 px-4 py-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("textarea",{ref:S,value:C,onChange:e=>T(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),D())},placeholder:"Ask me anything about medicine...",rows:1,className:"flex-1 px-4 py-3 rounded-xl bg-white/5 border border-white/10 text-white placeholder-gray-500 focus:outline-none focus:border-medical-blue focus:shadow-glow transition-all resize-none",style:{minHeight:"48px",maxHeight:"120px"}}),e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:D,disabled:!C.trim()||z,className:"px-6 py-3 rounded-xl bg-gradient-to-r from-medical-blue to-medical-purple hover:shadow-glow disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:z?e.jsx(n,{className:"w-5 h-5 animate-spin text-white"}):e.jsx(u,{className:"w-5 h-5 text-white"})})]})})})]}),e.jsxs("div",{className:"w-80 glass border-l border-white/10 p-4 hidden lg:block",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>T("Generate 5 practice questions about "+((null==y?void 0:y.title)||"general medicine")),className:"w-full p-3 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-medical-green/20 flex items-center justify-center",children:e.jsx(h,{className:"w-4 h-4 text-medical-green"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Practice Questions"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Generate quiz questions"})]})]})}),e.jsx("button",{onClick:()=>T("Summarize the key concepts from my recent studies"),className:"w-full p-3 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-medical-purple/20 flex items-center justify-center",children:e.jsx(a,{className:"w-4 h-4 text-medical-purple"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Summary"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Summarize recent topics"})]})]})}),e.jsx("button",{onClick:()=>T("Create a study plan for "+((null==v?void 0:v.level)||"medical student")),className:"w-full p-3 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-medical-blue/20 flex items-center justify-center",children:e.jsx(x,{className:"w-4 h-4 text-medical-blue"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Study Plan"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Get personalized plan"})]})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Recent Topics"}),e.jsx("div",{className:"space-y-2",children:["Cardiac Cycle","Antibiotics","Neuroanatomy","Diabetes Management"].map((s,t)=>e.jsx("button",{onClick:()=>T(`Tell me more about ${s}`),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 transition-colors",children:e.jsx("p",{className:"text-sm text-gray-300",children:s})},t))})]})]})]})};export{v as default};
